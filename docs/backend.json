
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a student user of the StudyTrack Journal.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "Full name of the user."
        }
      },
      "required": [
        "id",
        "email",
        "name"
      ]
    },
    "Activity": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Activity",
      "type": "object",
      "description": "Represents a logged activity by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Activity entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Activity)"
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the activity occurred.",
          "format": "date-time"
        },
        "type": {
          "type": "string",
          "description": "Type of activity (e.g., 'study', 'class', 'break')."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the activity."
        }
      },
      "required": [
        "id",
        "userId",
        "timestamp",
        "type",
        "description"
      ]
    },
    "Problem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Problem",
      "type": "object",
      "description": "Represents a problem solved by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Problem entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Problem)"
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the problem was solved.",
          "format": "date-time"
        },
        "category": {
          "type": "string",
          "description": "Category of the problem (e.g., 'math', 'physics', 'chemistry')."
        },
        "response": {
          "type": "string",
          "description": "User's response or solution to the problem."
        }
      },
      "required": [
        "id",
        "userId",
        "timestamp",
        "category",
        "response"
      ]
    }
  },
  "auth": {
    "providers": [
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/activities/{activityId}",
        "definition": {
          "entityName": "Activity",
          "schema": {
            "$ref": "#/backend/entities/Activity"
          },
          "description": "Stores activities logged by the user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "activityId",
              "description": "The unique identifier of the activity."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/problems/{problemId}",
        "definition": {
          "entityName": "Problem",
          "schema": {
            "$ref": "#/backend/entities/Problem"
          },
          "description": "Stores problems solved by the user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "problemId",
              "description": "The unique identifier of the problem."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to manage user data, activities, and solved problems for the StudyTrack Journal application. It prioritizes authorization independence, clarity, and scalability.  All data is owned by the user.  The structure uses path-based ownership (`/users/{userId}/...`) to guarantee that all data is private to the user. This simplifies the security rules significantly. No denormalization is required. This path-based strategy fulfills the QAPs and also authorization independence. Each collection directly under the user contains data of a similar security posture, simplifying the security rules."
  }
}
