{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a student user of the StudyTrack Journal application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "Full name of the user."
        }
      },
      "required": [
        "id",
        "email",
        "name"
      ]
    },
    "ActivityLog": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ActivityLog",
      "type": "object",
      "description": "Represents a log entry for a specific activity performed by a student.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the activity log entry."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N ActivityLog)"
        },
        "activityType": {
          "type": "string",
          "description": "Type of activity performed (e.g., 'Study', 'Class', 'Break')."
        },
        "startTime": {
          "type": "string",
          "description": "Date and time the activity started.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "Date and time the activity ended.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "Additional details or notes about the activity."
        }
      },
      "required": [
        "id",
        "userId",
        "activityType",
        "startTime",
        "endTime"
      ]
    },
    "ProblemSolved": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProblemSolved",
      "type": "object",
      "description": "Represents a record of a problem solved by a student.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the problem solved record."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N ProblemSolved)"
        },
        "dateSolved": {
          "type": "string",
          "description": "Date when the problem was solved.",
          "format": "date-time"
        },
        "category": {
          "type": "string",
          "description": "Category of the problem (e.g., 'Math', 'Science', 'Programming')."
        },
        "response": {
          "type": "string",
          "description": "The student's response or solution to the problem."
        }
      },
      "required": [
        "id",
        "userId",
        "dateSolved",
        "category",
        "response"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. User can only read/write their own profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/activityLogs/{activityLogId}",
        "definition": {
          "entityName": "ActivityLog",
          "schema": {
            "$ref": "#/backend/entities/ActivityLog"
          },
          "description": "Stores activity log entries for a specific user. Only the user can read/write their own activity logs.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "activityLogId",
              "description": "The unique identifier of the activity log entry."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/problemsSolved/{problemSolvedId}",
        "definition": {
          "entityName": "ProblemSolved",
          "schema": {
            "$ref": "#/backend/entities/ProblemSolved"
          },
          "description": "Stores the problems solved by a specific user. Only the user can read/write their own problems solved entries.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "problemSolvedId",
              "description": "The unique identifier of the problem solved entry."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure Authorization Independence, support QAPs (queries at scale), and maintain clear access control.  It leverages path-based ownership for user data and segregation to ensure homogeneous security postures for collections.\n\n*   **Users Collection:** `/users/{userId}` stores user profiles. This collection primarily serves authentication and user-specific configurations, not collaborative data.\n*   **Activity Logs:** `/users/{userId}/activityLogs/{activityLogId}` stores activity logs owned by a specific user.  Authorization is implicitly tied to the user ID in the path.\n*   **Problems Solved:** `/users/{userId}/problemsSolved/{problemSolvedId}` stores the questions solved by the students. Authorization is implicitly tied to the user ID in the path.\n\nThis structure achieves Authorization Independence by avoiding `get()` calls in security rules.  Each subcollection's data (activityLogs, problemsSolved) is directly associated with its parent user via the path, eliminating the need to fetch parent document data for authorization. QAPs are supported since each user's data is segregated into its own subcollection, allowing secure and scalable list operations."
  }
}